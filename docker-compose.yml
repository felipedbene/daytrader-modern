services:
  daytrader:
    image: daytrader-modern:latest
    build:
      context: .
      dockerfile: Dockerfile
    ports:
      - "9080:9080"
      - "9443:9443"
    environment:
      - DB_HOST=${DB_HOST:-10.0.100.104}
      - DB_PORT=${DB_PORT:-5432}
      - DB_NAME=${DB_NAME:-tradedb}
      - DB_USER=${DB_USER:-daytrader}
      - DB_PASSWORD=${DB_PASSWORD}
      - OIDC_CLIENT_ID=${OIDC_CLIENT_ID:-daytrader}
      - OIDC_CLIENT_SECRET=${OIDC_CLIENT_SECRET}
      - OIDC_DISCOVERY_URL=${OIDC_DISCOVERY_URL:-https://auth.k8s.debene.name/application/o/daytrader/.well-known/openid-configuration}
      - OIDC_REDIRECT_HOST=${OIDC_REDIRECT_HOST:-https://aix.debene.dev}
    extra_hosts:
      - "auth.k8s.debene.name:10.0.100.104"
    restart: unless-stopped
