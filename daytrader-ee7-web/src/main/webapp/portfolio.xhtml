<!--
 * (C) Copyright IBM Corporation 2015.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html  xmlns="http://www.w3.org/1999/xhtml"
       xmlns:h="http://xmlns.jcp.org/jsf/html"
       xmlns:f="http://xmlns.jcp.org/jsf/core"
       xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
       xmlns:fn="http://xmlns.jcp.org/jsp/jstl/functions">
<h:head>
	<title>DayTrader Portfolio</title>
	<link rel="stylesheet" href="style.css" type="text/css" />
	<link rel="shortcut icon" href="./favicon.ico" />
</h:head>
<h:body>

	<h:form id="portfolio">
		<nav class="dt-nav">
			<a href="tradehome.faces" class="dt-brand">
				<span class="dt-brand-icon">DT</span>
				DayTrader
			</a>
			<ul class="dt-nav-links">
				<li><h:outputLink value="tradehome.faces">Home</h:outputLink></li>
				<li><h:outputLink value="account.faces">Account</h:outputLink></li>
				<li><h:outputLink value="marketSummary.faces">Market</h:outputLink></li>
				<li><h:outputLink value="portfolio.faces" styleClass="active">Portfolio</h:outputLink></li>
				<li><h:outputLink value="quote.faces">Quotes/Trade</h:outputLink></li>
				<li><h:commandLink action="#{tradeapp.logout}" id="logoff">Logout</h:commandLink></li>
			</ul>
		</nav>

		<main class="dt-main">
			<div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:0.5rem;">
				<h:outputText value="#{accountdata.currentTime}" styleClass="text-muted" style="font-size:0.8125rem" />
			</div>

			<h:panelGroup rendered="#{fn:length(accountdata.closedOrders) > 0}">
				<div class="dt-alert dt-alert-warning">
					<strong>Alert:</strong> The following order(s) have completed.
					<h:dataTable id="orders" value="#{accountdata.closedOrders}" var="item" styleClass="table" headerClass="tableHeader"
						rowClasses="tableOddRow,tableEvenRow"
						columnClasses="tableColumn,tableColumn,tableColumn,tableColumn,tableColumn,tableColumn,tableColumn,tableColumn"
						style="margin-top:0.5rem;">

						<h:column>
							<f:facet name="header">
								<h:outputText value="Order ID" />
							</f:facet>
							<h:outputText value="#{item.orderID}" />
						</h:column>
						<h:column>
							<f:facet name="header">
								<h:outputText value="Status" />
							</f:facet>
							<h:outputText value="#{item.orderStatus}" />
						</h:column>
						<h:column>
							<f:facet name="header">
								<h:outputText value="Opened" />
							</f:facet>
							<h:outputText value="#{item.openDate}" />
						</h:column>
						<h:column>
							<f:facet name="header">
								<h:outputText value="Completed" />
							</f:facet>
							<h:outputText value="#{item.completionDate}" />
						</h:column>
						<h:column>
							<f:facet name="header">
								<h:outputText value="Fee" />
							</f:facet>
							<h:outputText value="#{item.orderFee}" />
						</h:column>
						<h:column>
							<f:facet name="header">
								<h:outputText value="Type" />
							</f:facet>
							<h:outputText value="#{item.orderType}" />
						</h:column>
						<h:column>
							<f:facet name="header">
								<h:outputText value="Symbol" />
							</f:facet>
							<h:outputText value="#{item.symbol}" />
						</h:column>
						<h:column>
							<f:facet name="header">
								<h:outputText value="Quantity" />
							</f:facet>
							<h:outputText value="#{item.quantity}" />
						</h:column>
					</h:dataTable>
				</div>
			</h:panelGroup>

			<div class="dt-card">
				<div class="dt-card-header">
					<h3>Portfolio</h3>
					<span class="dt-badge dt-badge-blue"><h:outputText value="#{portfolio.numberHoldings}" /> Holdings</span>
				</div>
				<div style="overflow-x:auto;">
					<h:dataTable id="holdings" value="#{portfolio.holdingDatas}" var="item" binding="#{portfolio.dataTable}" styleClass="table"
						headerClass="tableHeader" rowClasses="tableOddRow,tableEvenRow"
						columnClasses="tableColumn,tableColumn,tableColumn,tableColumn,tableColumn,tableColumn,tableColumn,tableColumn,tableColumn,tableColumn">

						<h:column>
							<f:facet name="header">
								<h:outputLink value="docs/glossary.html">
									<h:outputText value="Holding ID" />
								</h:outputLink>
							</f:facet>
							<h:outputText value="#{item.holdingID}" />
						</h:column>

						<h:column>
							<f:facet name="header">
								<h:outputLink value="docs/glossary.html">
									<h:outputText value="Purchase Date" />
								</h:outputLink>
							</f:facet>
							<h:outputText value="#{item.purchaseDate}" />
						</h:column>

						<h:column>
							<f:facet name="header">
								<h:outputLink value="docs/glossary.html">
									<h:outputText value="Symbol" />
								</h:outputLink>
							</f:facet>
							<h:outputText value="#{item.quoteID}" />
						</h:column>

						<h:column>
							<f:facet name="header">
								<h:outputLink value="docs/glossary.html">
									<h:outputText value="Quantity" />
								</h:outputLink>
							</f:facet>
							<h:outputText value="#{item.quantity}" />
						</h:column>

						<h:column>
							<f:facet name="header">
								<h:outputLink value="docs/glossary.html">
									<h:outputText value="Purchase Price" />
								</h:outputLink>
							</f:facet>
							<h:outputText value="#{item.purchasePrice}" />
						</h:column>

						<h:column>
							<f:facet name="header">
								<h:outputLink value="docs/glossary.html">
									<h:outputText value="Current Price" />
								</h:outputLink>
							</f:facet>
							<h:outputText value="#{item.price}" />
						</h:column>

						<h:column>
							<f:facet name="header">
								<h:outputLink value="docs/glossary.html">
									<h:outputText value="Basis" />
								</h:outputLink>
							</f:facet>
							<h:outputText value="#{item.basis}" />
						</h:column>

						<h:column>
							<f:facet name="header">
								<h:outputLink value="docs/glossary.html">
									<h:outputText value="Market Value" />
								</h:outputLink>
							</f:facet>
							<h:outputText value="#{item.marketValue}" />
						</h:column>

						<h:column>
							<f:facet name="header">
								<h:outputLink value="docs/glossary.html">
									<h:outputText value="Gain/(Loss)" />
								</h:outputLink>
							</f:facet>
							<h:outputText escape="false" value="#{item.gainHTML}" />
						</h:column>

						<h:column>
							<f:facet name="header">
								<h:outputLink value="docs/glossary.html">
									<h:outputText value="Trade" />
								</h:outputLink>
							</f:facet>
							<h:commandLink value="sell" action="#{portfolio.sell}" id="sell" styleClass="dt-btn dt-btn-danger dt-btn-sm" />
						</h:column>
					</h:dataTable>
				</div>
				<table class="table" style="margin-top:0.5rem;">
					<tr class="tableHeader">
						<th>Total Purchase Basis</th>
						<th>Total Market Value</th>
						<th>Total Gain/Loss</th>
					</tr>
					<tr style="background:var(--bg-secondary);font-weight:600;">
						<td style="text-align:center;">$<h:outputText value="#{portfolio.totalBasis}" /></td>
						<td style="text-align:center;">$<h:outputText value="#{portfolio.totalValue}" /></td>
						<td style="text-align:center;">$<h:outputText value="#{portfolio.totalGain}" /> <h:outputText escape="false" value="#{portfolio.totalGainPercentHTML}" /></td>
					</tr>
				</table>
			</div>

			<div class="dt-card">
				<div style="display:flex;justify-content:space-between;align-items:center;">
					<span class="text-muted">Click any <a href="docs/glossary.html">symbol</a> for a quote or to trade.</span>
					<div style="display:flex;gap:0.5rem;align-items:center;">
						<h:inputText id="symbols" value="#{quotedata.symbols}" required="true">
							<f:validateLength minimum="1" maximum="40" />
						</h:inputText>
						<h:commandButton class="dt-btn dt-btn-sm" id="submit2" type="submit" value="quotes" action="#{quotedata.getQuotesBySymbols}" />
					</div>
				</div>
			</div>
		</main>

		<footer class="dt-footer">
			Apache DayTrader Performance Benchmark Sample
		</footer>
	</h:form>

</h:body>
</html>
